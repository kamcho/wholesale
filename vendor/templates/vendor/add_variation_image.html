{% extends 'vendor/base.html' %}
{% load static %}

{% block extra_css %}
<style>
  .file-upload-container {
    position: relative;
    width: 100%;
    min-height: 200px;
    border: 2px dashed #d1d5db;
    border-radius: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f9fafb;
    transition: all 0.3s ease;
    cursor: pointer;
  }
  
  .file-upload-container:hover {
    border-color: #8b5cf6;
    background-color: #f5f3ff;
  }
  
  .file-upload-container.dragover {
    border-color: #8b5cf6;
    background-color: #f0e9ff;
    box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.3);
  }
  
  .file-upload-content {
    text-align: center;
    padding: 2rem 1rem;
  }
  
  .file-upload-icon {
    font-size: 2.5rem;
    color: #8b5cf6;
    margin-bottom: 1rem;
  }
  
  .file-upload-text h5 {
    margin-bottom: 0.5rem;
    color: #1f2937;
  }
  
  .file-upload-text p {
    color: #6b7280;
    margin-bottom: 0.5rem;
  }
  
  .file-input {
    display: none;
  }
  
  #image-preview {
    display: none;
    max-width: 100%;
    max-height: 300px;
    margin: 0 auto;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
</style>
{% endblock %}

{% block title %}Add Variation Image - {{ product.name }}{% endblock %}

{% block content %}
<div class="container-fluid px-4">
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-3 mb-4 border-bottom">
    <div class="d-flex align-items-center">
      <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center me-3">
        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
      </div>
      <h1 class="h4 mb-0 fw-bold">Add Variation Image</h1>
    </div>
    <div class="btn-toolbar">
      <a href="{% url 'vendor:edit_product_variation' variation.id %}" class="btn btn-outline-secondary hover-lift">
        <svg class="w-4 h-4 me-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        Back to Variation
      </a>
    </div>
  </div>

  <div class="card border-0 shadow-lg hover-lift mb-4">
    <div class="card-header border-0 bg-gradient-to-r from-purple-50 to-pink-50 d-flex justify-content-between align-items-center">
      <h5 class="card-title mb-0 d-flex align-items-center">
        <span class="badge bg-gradient-to-r from-purple-100 to-pink-100 text-purple-800 me-2">{{ product.name }}</span>
        <span class="text-muted">/</span>
        <span class="ms-2">{{ variation.name }}</span>
      </h5>
    </div>
    <div class="card-body p-4">
      <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
        {% csrf_token %}
        
        <div class="row g-4">
          <!-- Image Upload -->
          <div class="col-12">
            <div id="drop-zone" class="border-2 border-dashed rounded-3 p-5 text-center bg-gradient-to-br from-gray-50 to-gray-100 hover-lift" style="cursor: pointer;">
              <div id="image-preview" class="mb-3" style="display: none;">
                <img id="preview" src="#" alt="Preview" class="img-fluid rounded-3 shadow-sm" style="max-height: 300px;">
              </div>
              <div class="file-input-wrapper">
                {{ form.image }}
                <div id="upload-area" class="file-input-label">
                  <div class="w-16 h-16 bg-gradient-to-r from-purple-100 to-pink-100 rounded-full flex items-center justify-center mx-auto mb-3">
                    <svg class="w-8 h-8 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                    </svg>
                  </div>
                  <h6 class="mb-1">Drag & drop your image here</h6>
                  <p class="text-muted small mb-3">or click to browse files</p>
                  {% if form.image.errors %}
                    <div class="text-danger small mt-2">
                      {% for error in form.image.errors %}<div>{{ error }}</div>{% endfor %}
                    </div>
                  {% endif %}
                  <p class="text-muted small mt-2">JPG, PNG or WebP. Max 5MB.</p>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Caption -->
          <div class="col-md-8">
            <label class="form-label fw-medium">Caption <span class="text-muted">(Optional)</span></label>
            {{ form.caption }}
            <div class="form-text">A short description for this image (max 200 characters)</div>
          </div>
          
          <!-- Default Image Toggle -->
          <div class="col-md-4">
            <div class="form-check form-switch">
              {{ form.is_default }}
              <label class="form-check-label fw-medium" for="{{ form.is_default.id_for_label }}">
                Set as default image
              </label>
              <div class="form-text">This will be the main image shown for this variation</div>
            </div>
          </div>
        </div>

        <div class="d-flex justify-content-end gap-3 mt-5 pt-4 border-top">
          <a href="{% url 'vendor:edit_product_variation' variation.id %}" class="btn btn-outline-secondary hover-lift">
            <svg class="w-4 h-4 me-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
            Cancel
          </a>
          <button type="submit" class="btn btn-primary hover-lift">
            <svg class="w-4 h-4 me-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
            </svg>
            Upload Image
          </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
